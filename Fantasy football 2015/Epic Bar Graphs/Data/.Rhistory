dir.create(path.dir)
dir.create(path.dir, showWarnings = F)
path.file <- paste(path.dir, '/', league.name, 'Week ', nfl.week, ' roster snapshot.txt')
league.name <- league.id
path.file <- paste(path.dir, '/', league.name, 'Week ', nfl.week, ' roster snapshot.txt')
path.file
path.file <- paste(path.dir, '/', league.name, 'Week ', nfl.week, ' roster snapshot.txt', sep = '')
path.file
path.file <- paste(path.dir, '/', league.name, ' week ', nfl.week, ' roster snapshot.txt', sep = '')
path.file
league.id <- '1390327'
league.name <- switch(league.id
, "1390327" = "Epic Bar Graphs"
, "1637123" = "Belicheck Your Balls"
, "1702312" = "CAmazonians"
, "1765344" = "Just Here So I Will Not Get Fined")
league.name
path.dir  <- file.path('/Users/pgowey/Github/Resources/Fantasy football 2015', league.name)
path.dir
path.file <- paste(path.dir, '/', league.name, ' week ', nfl.week, ' roster snapshot.txt', sep = '')
dir.create(path.dir, showWarnings = F)  # don't show the warning if dir already exists
path.file
write.table(snapshot, path.file, sep = '\t', row.names = F, col.names = T, quote = F)
length(league.list)
league.list <- c("1390327",  # Epic Bar Graphs
#"1637123",  # Belicheck Your Balls  # Belicheck won't work yet because not all the IDP positions are filled in
"1702312",  # CAmazonians
"1765344"   # Won't Get Fined
)
length(league.list)
h
h <- 1
cat('processing league ', h, ' out of ', length(league.list), ': ', league.name, '\n', sep = '')
source('~/GitHub/Resources/Fantasy football 2015/weekly power rankings.R', echo=TRUE)
source('~/GitHub/Resources/Fantasy football 2015/weekly power rankings.R', echo=TRUE)
head(snapshot)
mgr.pts <- snapshot %>% group_by(manager) %>% summarise(starter.pts = sum(starter.pts, na.rm = T), bench.pts = sum(bench.pts, na.rm = T))
mgr.pts
mgr.pts <- melt(mgr.pts, id = c('manager'))
library(reshape2)
mgr.pts <- melt(mgr.pts, id = c('manager'))
mgr.pts
mgr.pts <- snapshot %>% group_by(manager) %>% summarise("Starter points" = sum(starter.pts, na.rm = T), "Bench points" = sum(bench.pts, na.rm = T))
mgr.pts
mgr.pts <- melt(mgr.pts, id = c('manager'))
mgr.pts
mgr.pts <- snapshot %>% group_by(Manager = manager) %>% summarise("Starter points" = sum(starter.pts, na.rm = T), "Bench points" = sum(bench.pts, na.rm = T))
mgr.pts <- melt(mgr.pts, id = c('Manager'))
mgr.pts
ggplot(data = mgr.pts, aes(x = manager, weight = value)) +
geom_bar(binwidth = 1)
ggplot(data = mgr.pts, aes(x = Manager, weight = value)) +
geom_bar(binwidth = 1)
ggplot(data = mgr.pts, aes(x = Manager, weight = value)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable)
ggplot(data = mgr.pts, aes(x = Manager, weight = value)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1)
mgr.rank <- mgr.pts %>% filter(variable == 'Starter points') %>% arrange(desc(value)) %>% select(Manager)
mgr.rank
mgr.pts$Manager <- factor(mgr.pts$Manager, levels = mgr.rank$Manager)
mgr.pts
ggplot(data = mgr.pts, aes(x = Manager, weight = value)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1)
ggplot(data = mgr.pts, aes(x = Manager, weight = value)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
theme(x.axis.text = element_text(rotate = "90"))
ggplot(data = mgr.pts, aes(x = Manager, weight = value)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(data = mgr.pts, aes(x = Manager, weight = value)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data = mgr.pts, aes(x = Manager, weight = value)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, " week ", nfl.week, " power rankings", sep = '')
)
ggplot(data = mgr.pts, aes(x = Manager, weight = value)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = '')
ggplot(data = mgr.pts, aes(x = Manager, weight = value)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
league$link[i]
source('~/GitHub/Resources/Fantasy football 2015/weekly power rankings.R', echo=TRUE)
?ggsave
path.dir
ggsave(filename = graph.file, plot = power.ranks, height = 6, width = 5)
power.ranks <- ggplot(data = mgr.pts, aes(x = Manager, weight = value)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
graph.dir  <- file.path(base.dir, 'Graphs')
base.dir   <- file.path('/Users/pgowey/Github/Resources/Fantasy football 2015', league.name)
graph.dir  <- file.path(base.dir, 'Graphs')
graph.file <- paste(graph.dir, '/', league.name, ' week ', nfl.week, ' power rankings.jpg', sep = '')
dir.create(graph.dir, showWarnings = F)  # don't show the warning if dir already exists
ggsave(filename = graph.file, plot = power.ranks, height = 6, width = 5)
ggsave(filename = graph.file, plot = power.ranks, height = 12, width = 10)
ggsave(filename = graph.file, plot = power.ranks, height = 10, width = 8)
source('~/GitHub/Resources/Fantasy football 2015/weekly power rankings.R', echo=TRUE)
power.ranks
schedule <- htmlParse('http://games.espn.go.com/ffl/schedule?leagueId=1390327')[1]
schedule <- readHTMLTable('http://games.espn.go.com/ffl/schedule?leagueId=1390327')[1]
head(schedule)
schedule[1,1]
schedule[1,]
schedule
schedule$V1
ncol(schedule)
str(schedule)
class(schedule)
schedule <- readHTMLTable('http://games.espn.go.com/ffl/schedule?leagueId=1390327')[1] %>% as.data.frame()
head(schedule)
schedule[1,1]
schedule[1,2]
schedule[1,2:10]
schedule[1:10,1]
league
h <- 1
league.id <- league.list[h]
league.name <- switch(league.id
, "1390327" = "Epic Bar Graphs"
, "1637123" = "Belicheck Your Balls"
, "1702312" = "CAmazonians"
, "1765344" = "Just Here So I Will Not Get Fined")
cat('processing league ', h, ' out of ', length(league.list), ': ', league.name, '\n', sep = '')
# create NFL calendar
# wk 1 starts 9/9/2015 and there are 16-17 weeks in fantasy
start <- as.Date('2015-09-09', '%Y-%m-%d')
nfl.week <- floor(as.numeric(Sys.Date() - start)/7)+1
nfl.week <- ifelse(nfl.week > 17, 99, ifelse(Sys.Date() < start, 0, nfl.week))
league.html <- paste('http://games.espn.go.com/ffl/standings?leagueId=', league.id, '&seasonId=2015', sep = '')
league.xml <- htmlParse(league.html)
# all_links <- unlist(xpathSApply(home,"//table[@class='tableBody']//a",xmlAttrs))
league.links <- xpathSApply(league.xml,"//div[@class='games-fullcol games-fullcol-extramargin']/table[@cellpadding='0']//a/@href") %>% data.frame()
league.names <- xpathSApply(league.xml,"//div[@class='games-fullcol games-fullcol-extramargin']/table[@cellpadding='0']//a/@title") %>% data.frame()
names(league.links) <- c('link')
names(league.names) <- c('manager')
league <- data.frame(manager = league.names, link = as.character(paste('http://games.espn.go.com', league.links$link, sep = '')), stringsAsFactors = F)
league$manager.name <- gsub('.*\\((.*)\\).*', '\\1', as.character(league$manager))
starting.positions <- c('QB','RB','WR','TE','FLEX','D/ST','K')
bench.positions <- c('Bench','IR')
league
schedule[2:10,1:2]
schedule[2:10,c(2,5)]
schedule <- schedule[2:nrow(schedule),c(2,5)]
names(schedule) <- c('p1','p2')
schedule
schedule <- filter(schedule, p1 != '<NA>', p2 != '<NA>')
tail(schedule)
schedule
length(league)
nrow(league)
60/5
schedule$row.id <- c(1:nrow(schedule))
schedule
schedule <- filter(schedule, p1 != '<NA>', p2 != '<NA>', p1 != 'OWNER(S)', p2 != 'OWNER(S)')
schedule$row.id <- c(1:nrow(schedule))
schedule
schedule$nfl.wk <- floor(schedule$row.id / (nrow(league)/2))+1
schedule
schedule$nfl.wk <- floor(schedule$row.id-1 / (nrow(league)/2))+1
schedule
schedule$nfl.wk <- floor((schedule$row.id-1) / (nrow(league)/2))+1
schedule
nfl.week
schedule <- filter(schedule, wk = nfl.week)
schedule <- filter(schedule, wk == nfl.week)
schedule$wk <- floor((schedule$row.id-1) / (nrow(league)/2))+1
schedule <- filter(schedule, wk == nfl.week)
schedule
schedule$matchup.id <- c(1:nrow(schedule))
schedule
schedule %>% select(p1,p2) %>% melt(id = c('matchup.id'))
schedule %>% select(p1,p2,matchup.id) %>% melt(id = c('matchup.id'))
head(snapshot)
schedule <- readHTMLTable(paste('http://games.espn.go.com/ffl/schedule?leagueId=', league.id)[1] %>% as.data.frame()
schedule <- schedule[2:nrow(schedule),c(2,5)]
schedule <- readHTMLTable(paste('http://games.espn.go.com/ffl/schedule?leagueId=', league.id)[1] %>% as.data.frame()
schedule <- readHTMLTable(paste('http://games.espn.go.com/ffl/schedule?leagueId=', league.id, sep = ''))[1] %>% as.data.frame()
schedule <- schedule[2:nrow(schedule),c(2,5)]
names(schedule) <- c('p1','p2')
schedule <- filter(schedule, p1 != '<NA>', p2 != '<NA>', p1 != 'OWNER(S)', p2 != 'OWNER(S)')
schedule$row.id <- c(1:nrow(schedule))
schedule$wk <- floor((schedule$row.id-1) / (nrow(league)/2))+1
schedule <- filter(schedule, wk == nfl.week)
schedule$matchup.id <- c(1:nrow(schedule))
schedule <- schedule %>% select(p1,p2,matchup.id) %>% melt(id = c('matchup.id')) %>% select(manager = value, matchup.id)
schedule
snapshot <- left_join(snapshot, schedule, by = c('manager' = 'manager'))
head(snapshot)
mgr.pts
source('~/.active-rstudio-document', echo=TRUE)
library(RColorBrewer)
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = matchup.id)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer()
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = matchup.id)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer() +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = matchup.id)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_discrete(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666'))
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = matchup.id)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_discrete(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = matchup.id)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_color_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = matchup.id)) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_color_brewer() +
#scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
?RColorBrewer
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_color_brewer(pal = 'Dark2') +
#scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_color_brewer(palette = 'Dark2') +
#scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_color_brewer(palette = 'Set1') +
#scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_colour_brewer(palette="Set1") +
#scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_colour_brewer(palette="Set2") +
#scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
#         scale_colour_brewer(palette = "Set2") +
scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
factor(mgr.pts$matchup.id)
mgr.pts
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Set2") +
#         scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Set1") +
#         scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Dark1") +
#         scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Dark2") +
#         scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Set3") +
#         scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Set1") +
#         scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Accent") +
#         scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
# Accent    8
# Dark2	8
# Paired	12
# Pastel1	9
# Pastel2	8
# Set1	9
# Set2	8
# Set3	12
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Paired") +
#         scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
# Accent    8
# Dark2	8
# Paired	12
# Pastel1	9
# Pastel2	8
# Set1	9
# Set2	8
# Set3	12
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Pastel1") +
#         scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
# Accent    8
# Dark2	8
# Paired	12
# Pastel1	9
# Pastel2	8
# Set1	9
# Set2	8
# Set3	12
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Pastel2") +
#         scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
# Accent    8
# Dark2	8
# Paired	12
# Pastel1	9
# Pastel2	8
# Set1	9
# Set2	8
# Set3	12
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Set1") +
#         scale_fill_manual(values = c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#a6761d','#666666')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
# Accent    8
# Dark2	8
# Paired	12
# Pastel1	9
# Pastel2	8
# Set1	9
# Set2	8
# Set3	12
source('~/GitHub/Resources/Fantasy football 2015/weekly power rankings.R', echo=TRUE)
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Set1") +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''), legend = 'Matchup Id')
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Set1") +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''), guide = 'Matchup Id')
ggplot(data = mgr.pts, aes(x = Manager, weight = value, fill = factor(matchup.id))) +
geom_bar(binwidth = 1) +
facet_wrap(~ variable, ncol = 1) +
scale_fill_brewer(palette = "Set1", name = 'Matchup Id') +
theme(axis.text.x = element_text(angle = 45, hjust = 1), plot.title = element_text(size = 18, face = 'bold', vjust = 2, hjust = 0)) +
labs(x = "Manager", y = paste("Projected points: week ", nfl.week, sep = ''), title = paste(league.name, ": Week ", nfl.week, " Power Rankings", sep = ''))
source('~/GitHub/Resources/Fantasy football 2015/weekly power rankings.R', echo=TRUE)
source('~/GitHub/Resources/Fantasy football 2015/weekly power rankings.R', echo=TRUE)
power.ranks
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
power.ranks
base.dir   <- file.path('/Users/pgowey/Github/Resources/Fantasy football 2015', league.name)
data.dir   <- file.path(base.dir, 'Data')
data.file  <- paste(data.dir, '/', league.name, ' week ', nfl.week, ' roster snapshot.txt', sep = '')
dir.create(data.dir, showWarnings = F)  # don't show the warning if dir already exists
write.table(snapshot, data.file, sep = '\t', row.names = F, col.names = T, quote = F)
base.dir
data.dir
dir.create(data.dir, showWarnings = T)  # don't show the warning if dir already exists
base.dir   <- file.path('/Users/pgowey/Github/Resources/Fantasy football 2015', league.name)
data.dir   <- file.path(base.dir, 'Data')
data.file  <- paste(data.dir, '/', league.name, ' week ', nfl.week, ' roster snapshot.txt', sep = '')
dir.create(data.dir, showWarnings = T)  # don't show the warning if dir already exists
data.dir
data.file
graph.dir
base.dir   <- file.path('/Users/pgowey/Github/Resources/Fantasy football 2015', league.name)
dir.create(base.dir, showWarnings = F)
data.dir   <- file.path(base.dir, 'Data')
data.file  <- paste(data.dir, '/', league.name, ' week ', nfl.week, ' roster snapshot.txt', sep = '')
dir.create(data.dir, showWarnings = T)  # don't show the warning if dir already exists
write.table(snapshot, data.file, sep = '\t', row.names = F, col.names = T, quote = F)
graph.dir  <- file.path(base.dir, 'Graphs')
graph.file <- paste(graph.dir, '/', league.name, ' week ', nfl.week, ' power rankings.jpg', sep = '')
dir.create(graph.dir, showWarnings = F)  # don't show the warning if dir already exists
ggsave(filename = graph.file, plot = power.ranks, height = 10, width = 8)
source('~/.active-rstudio-document', echo=TRUE)
source('~/GitHub/Resources/Fantasy football 2015/weekly matchup outcomes.R', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
files <- files[grep('.*scoring and projections.txt',files)]
files <- list.files()
files <- files[grep('.*scoring and projections.txt',files)]
files
scoring.file <- max(files)
scoring.file
scoring <- read.table(scoring.file, header = T, sep = '\t', quote = '', fill = T)
head(scoring)
head(scoring,20)
scoring.agg <- scoring %>% group_by(manager, player.info) %>% summarise(pts = sum(score,na.rm= T)) %>% mutate(rank = rank(pts))
head(scoring.agg)
head(scoring.agg,20)
scoring.agg <- scoring %>% group_by(manager, player.info) %>% summarise(pts = sum(score,na.rm= T)) %>% mutate(rank = rank(desc(pts)))
head(scoring.agg,20)
scoring.agg <- scoring %>% group_by(manager, player.info) %>% summarise(pts = sum(score,na.rm= T)) %>% mutate(rank = rank(desc(pts))) %>% arrange(rank)
head(scoring.agg,20)
filter(scoring.agg, rank <= 3)
filter(scoring.agg, manager == 'Patrick Gowey')
names(scoring)
head(scoring,1)
filter(scoring, player == 'Dion Lewis')
filter(scoring, player == 'Stephen Gostowski')
filter(scoring, player == 'Stephen Gostkowski')
filter(scoring, player == 'DeMarco Murray')
head(scoring.agg)
scoring.agg[grep('.*RB$',scoring.agg$player.info),]
scoring.agg[grep('.*RB$',scoring.agg$player.info),] %>% arrange(rank)
scoring.agg[grep('.*RB$',scoring.agg$player.info),] %>% as.data.frame() %>% arrange(rank)
source('~/GitHub/Resources/Fantasy football 2015/weekly matchup outcomes.R', echo=TRUE)
source('~/GitHub/Resources/Fantasy football 2015/weekly matchup outcomes.R', echo=TRUE)
scoring.agg <- scoring %>% group_by(manager, player.info) %>% summarise(pts = sum(score,na.rm= T)) %>% mutate(rank = rank(desc(pts))) %>% arrange(rank)
head(scoring.agg)
source('~/.active-rstudio-document', echo=TRUE)
head(scoring.agg)
filter(scoring.agg, manager == 'J Carbonetti')
filter(scoring.agg, manager == 'Patrick Gowey')
names(scoring)
scoring.agg <- scoring %>% group_by(manager, player.info) %>% summarise(player.name = max(player), team = max(team), position = max(position), pts = sum(score,na.rm= T)) %>% mutate(rank = rank(desc(pts))) %>% arrange(rank) %>% select(manager, player.name, team, position, pts, rank)
source('~/.active-rstudio-document', echo=TRUE)
head(scoring.agg)
write.table(scoring.agg, 'player ranks per manager.txt', sep = '\t', row.names = F, col.names = T, quote = F)
